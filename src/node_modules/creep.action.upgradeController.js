const ActionNode = require('tree.node.action')

class UpgradeController extends ActionNode {
  tick (context) {
    var creep = context.actor

    if (creep.carry[RESOURCE_ENERGY] === 0) {
      this.log(context, 'Not enough energy')
      return FAILURE
    }

    var status = creep.upgradeController(creep.room.controller)
    if (status === OK) {
      this.log(context, 'Upgrading controller')
      return RUNNING
    }

    if (status === ERR_NOT_IN_RANGE) {
      this.log(context, 'Tried to upgrade controller, but need to move closer to controller')
      creep.moveTo(creep.room.controller)
    }

    return RUNNING
  }
}

module.exports = UpgradeController
