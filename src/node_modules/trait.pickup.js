/**
 * Pickup Trait
 * When the creep is near dropped energy, pick it up.
 *
 * @param {Creep} creep
 * @returns {boolean} whether a task was assigned or not
 */
module.exports = (creep) => {
  // TODO: decide max distance according to speed
  var MAX_DISTANCE = 5

  // Creeps without the ability to carry should be skipped
  if (creep.getActiveBodyParts(CARRY) === 0) {
    return false
  }

  // Creep is full of energy, not possible to pick up.
  if (creep.carry.energy === creep.carryCapacity) {
    return false
  }

  var source = creep.pos.findInRange(FIND_DROPPED_ENERGY, MAX_DISTANCE)
  // Nothing is close, stop it.
  if (!source) {
    return false
  }

  // Try to pick up.
  switch (creep.pickup(source)) {
    // When not in range try to move closer.
    case ERR_NOT_IN_RANGE:
      var moveStatus = creep.moveTo(target)
      return (moveStatus === OK) || (moveStatus = ERR_TIRED)
    // Creep is picking up.
    case OK:
      return true
    // Something other error, so we didn't assign a task after all.
    default:
      return false
  }
}
