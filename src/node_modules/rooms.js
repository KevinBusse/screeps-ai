var layouts = {}
layouts.basic = require('room.basic')

var defaultLayout = 'basic'

module.exports = () => {
  var memory = Memory.rooms = Memory.rooms || {}

  _.each(Game.rooms, (room) => {
    // Check whether the room already has a memory, create & notify otherwise.
    if (typeof memory[room.name] !== 'object') {
      memory[room.name] = {layout: defaultLayout}
      Game.notify('New room "' + room.name + '", assuming "' + defaultLayout + '" layout.')
    }

    // Check whether a definition for the specified layout exists.
    if (!_.has(layouts, memory[room.name].layout)) {
      Game.notify('Layout "' + memory[room.name].layout + '" for room "' + room.name + '" is not defined.')
      return
    }

    // Execute the layout specification.
    layouts[memory[room.name].layout](room)
  })
}
