const Tree = require('tree')
const Selector = require('tree.composite.selector')
const Sequence = require('tree.composite.sequence')
const Invert = require('tree.decorator.invert')

const HasCreeps = require('room.condition.hasCreeps')

const BuildStructure = require('room.action.buildStructure')
const BuildBaseStructure = require('room.action.buildBaseStructure')
const SpawnCreep = require('room.action.spawnCreep')
const SpawnHarvesterPerSource = require('room.action.spawnHarvesterPerSource')

module.exports = new Tree(
  'room.basic',
  new Selector('prio', [
    new Sequence('workforce', [
      new Invert('not1',
        new HasCreeps('checkCreepCount', {min: 5})
      ),
      new SpawnCreep('SpawnWorker', {
        behavior: 'worker',
        baseBody: [WORK, CARRY, MOVE],
        scaleBody: [WORK, CARRY, MOVE],
        max: 5
      })
    ]),
    new Sequence('digforce', [
      new HasCreeps('checkCreepCount', {min: 5}),
      new SpawnHarvesterPerSource('spawnHarvesters')
    ]),
    new BuildStructure('TowerBuilder', {structureType: STRUCTURE_TOWER}),
    new BuildStructure('ExtensionBuilder', {structureType: STRUCTURE_EXTENSION}),
    new BuildBaseStructure('StorageBuilder', {structureType: STRUCTURE_STORAGE})
    // new BuildBaseStructure('SpawnBuilder', {structureType: STRUCTURE_SPAWN}),
    // new BuildBaseStructure('TerminalBuilder', {structureType: STRUCTURE_TERMINAL})
  ])
)

