const ActionNode = require('tree.node.action')

class Construct extends ActionNode {
  tick (context) {
    var creep = context.actor
    var sites = creep.room.find(FIND_MY_CONSTRUCTION_SITES)

    if (sites.length === 0) {
      this.log(context, 'No open construction sites')
      return FAILURE
    }

    if (creep.energy === 0) {
      return FAILURE
    }

    var site = creep.pos.findClosestByPath(sites)
    if (creep.build(site) === ERR_NOT_IN_RANGE) {
      creep.moveTo(site)
    }

    return RUNNING
  }
}

module.exports = Construct
