const ActionNode = require('tree.node.action')

class Dig extends ActionNode {
  tick (context) {
    var creep = context.actor
    var source

    if (!creep.memory.digSource) {
      this.log(context, 'No source assigned to dig.')
      return FAILURE
    }

    source = Game.getObjectById(creep.memory.digSource)
    var status = creep.harvest(source)
    if (status === ERR_NOT_IN_RANGE) {
      this.log(context, 'Not in range, moving closer.')
      creep.moveTo(source)
    }
    this.log(context, status)

    return RUNNING
  }
}

module.exports = Dig
