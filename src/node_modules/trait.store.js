module.exports = (creep) => {
  var targets = creep.room.find(FIND_MY_STRUCTURES, {
    filter: (structure) => {
      return (
        (
          structure.structureType === STRUCTURE_EXTENSION ||
          structure.structureType === STRUCTURE_SPAWN ||
          structure.structureType === STRUCTURE_TOWER
        ) && structure.energy < structure.energyCapacity
      )
    }
  })

  // No storage structures with capacity found, do something else with the energy.
  if (targets.length === 0) {
    return false
  }

  // Choose closest target.
  var target = creep.pos.findClosestByRange(targets)

  // Try to transfer.
  switch (creep.transfer(target)) {
    // When not in range try to move closer.
    case ERR_NOT_IN_RANGE:
      var moveStatus = creep.moveTo(target)
      return (moveStatus === OK) || (moveStatus = ERR_TIRED)
    // Creep is transferring.
    case OK:
      return true
    // Something other error, so we didn't assign a task after all.
    default:
      return false
  }
}
