const ActionNode = require('tree.node.action')

class TransferEnergyToSpawn extends ActionNode {
  tick (context) {
    var creep = context.actor
    var fillTarget = this.params.max || 1

    var target = creep.pos.findClosestByPath(FIND_MY_SPAWNS, {
      filter: spawn => spawn.energy < spawn.energyCapacity * fillTarget
    })

    if (!target) {
      return FAILURE
    }

    if (creep.transfer(target, RESOURCE_ENERGY) === ERR_NOT_IN_RANGE) {
      creep.moveTo(target)
    }

    return RUNNING
  }
}

module.exports = TransferEnergyToSpawn
